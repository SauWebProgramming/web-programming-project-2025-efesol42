@model IEnumerable<global::Product>
@{
    Layout = "~/Views/Shared/_LayoutSeller.cshtml";
}

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Plus+Jakarta+Sans:wght@700&family=Poppins:wght@600&display=swap" rel="stylesheet">

<div class="container-fluid py-4" style="background-color: #fcfcfc; font-family: 'Inter', sans-serif;">

    <div class="mb-4">
        <div class="d-flex align-items-center gap-2 mb-2">
            <div style="width: 15px; height: 35px; background: #DB4444; border-radius: 4px"></div>
            <span class="text-danger fw-bold">Featured</span>
        </div>
        <h2 class="fw-bold">latest Analizes for sale</h2>
    </div>

    <div class="row g-4 mb-4">
        <div class="col-md-4">
            <div class="card border-0 shadow-sm p-4" style="border-radius: 20px; height: 153px; position: relative; background: white;">
                <div style="color: #DB4444; font-size: 14px;">Orders Count</div>
                <div style="font-family: 'Plus Jakarta Sans'; font-weight: 700; font-size: 23.3px;">@ViewBag.TotalOrders</div>
                <div style="position: absolute; right: 10px; bottom: 10px; width: 150px; height: 80px;">
                    <canvas id="ordersChart"></canvas>
                </div>
            </div>
        </div>

        <div class="col-md-4">
            <div class="card border-0 shadow-sm p-4" style="border-radius: 20px; height: 153px; position: relative; background: white;">
                <div style="color: #DB4444; font-size: 14px;">Total Revenue</div>
                <div style="font-family: 'Plus Jakarta Sans'; font-weight: 700; font-size: 23.3px;">$@ViewBag.TotalRevenue</div>
                <div style="position: absolute; right: 10px; bottom: 10px; width: 150px; height: 80px;">
                    <canvas id="revenueChart"></canvas>
                </div>
            </div>
        </div>

        <div class="col-md-4">
            <div class="card border-0 shadow-sm p-4" style="border-radius: 20px; height: 153px; position: relative; background: white;">
                <div style="color: #DB4444; font-size: 14px;">Active Users</div>
                <div style="font-family: 'Plus Jakarta Sans'; font-weight: 700; font-size: 23.3px;">@ViewBag.TotalUsers</div>
                <div style="position: absolute; right: 10px; bottom: 10px; width: 150px; height: 80px;">
                    <canvas id="usersChart"></canvas>
                </div>
            </div>
        </div>
    </div>

    <div class="row g-4 mb-5">
        <div class="col-lg-8">
            <div class="card border-0 shadow-sm overflow-hidden" style="height: 230px; border-radius: 20px;">
                <div style="padding: 24px 32px;">
                    <h5 style="font-family: 'Plus Jakarta Sans'; font-weight: 700; font-size: 16.7px; color: #111927;">Today's Stats</h5>
                </div>

                <div class="d-flex justify-content-around px-4">
                    <div style="width: 30%; height: 114px; background: #FEF3F2; border-radius: 20px; padding: 20px;" class="d-flex align-items-center gap-3">
                        <div style="width: 48px; height: 48px; background: #FF624D; border-radius: 12px; display:flex; align-items:center; justify-content:center;">
                            <i class="bi bi-cart-check text-white fs-4"></i>
                        </div>
                        <div>
                            <div style="color: #6C737F; font-size: 14px;">Today Sales</div>
                            <div style="font-family: 'Plus Jakarta Sans'; font-weight: 700; font-size: 20px;">$@ViewBag.TodaySales</div>
                        </div>
                    </div>

                    <div style="width: 30%; height: 114px; background: #FFFAEB; border-radius: 20px; padding: 20px;" class="d-flex align-items-center gap-3">
                        <div style="width: 48px; height: 48px; background: #FFB37F; border-radius: 12px; display:flex; align-items:center; justify-content:center;">
                            <i class="bi bi-cash-stack text-white fs-4"></i>
                        </div>
                        <div>
                            <div style="color: #6C737F; font-size: 14px;">All Orders</div>
                            <div style="font-family: 'Plus Jakarta Sans'; font-weight: 700; font-size: 20px;">@ViewBag.TotalOrders</div>
                        </div>
                    </div>

                    <div style="width: 30%; height: 114px; background: #F0FDF9; border-radius: 20px; padding: 20px;" class="d-flex align-items-center gap-3">
                        <div style="width: 48px; height: 48px; background: #26AB5B; border-radius: 12px; display:flex; align-items:center; justify-content:center;">
                            <i class="bi bi-graph-up-arrow text-white fs-4"></i>
                        </div>
                        <div>
                            <div style="color: #6C737F; font-size: 14px;">Active Items</div>
                            <div style="font-family: 'Plus Jakarta Sans'; font-weight: 700; font-size: 20px;">@ViewBag.TotalProducts</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-lg-4">
            <div class="card border-0 shadow-sm overflow-hidden" style="height: 230px; border-radius: 20px;">
                <div style="padding: 24px;" class="d-flex justify-content-between align-items-center border-bottom">
                    <h5 style="font-family: 'Plus Jakarta Sans'; font-weight: 700; font-size: 16.7px; color: #111927; margin:0;">Sales by Country</h5>
                    <i class="bi bi-info-circle text-muted"></i>
                </div>
                <div class="table-responsive">
                    <table class="table mb-0 align-middle">
                        <thead style="background: #F8F9FA;">
                            <tr style="font-family: 'Inter'; font-weight: 600; font-size: 11px; color: #2F3746; text-transform: uppercase;">
                                <th class="ps-4">Country</th>
                                <th>Value</th>
                                <th>SEO</th>
                            </tr>
                        </thead>
                        <tbody>
                            @if (ViewBag.CountryStats != null)
                            {
                                foreach (var c in ViewBag.CountryStats)
                                {
                                    <tr style="font-size: 13px;">
                                        <td class="ps-4 fw-medium">@c.Name</td>
                                        <td>@c.Value</td>
                                        <td class="text-success">@c.SEO</td>
                                    </tr>
                                }
                            }
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <div class="mb-4">
        <div class="d-flex align-items-center gap-2 mb-2">
            <div style="width: 15px; height: 35px; background: #DB4444; border-radius: 4px"></div>
            <span class="text-danger fw-bold">Featured</span>
        </div>
        <h2 class="fw-bold">latest Products for sale</h2>
    </div>

    <div class="row g-4">
        @foreach (var item in Model)
        {
            <div class="col">
                <div onclick="location.href='@Url.Action("Details", "Product", new { id = item.Id })'" class="card h-100 border-0 shadow-sm product-card overflow-hidden" style="width:100%;border-radius: 12px;">
                    <div class="position-relative" style="height: 250px; background-color: #F5F5F5;">
                        @if (item.Images != null && item.Images.Any())
                        {
                            <img src="@item.Images.First().ImageUrl" class="card-img-top h-100 w-100" style="object-fit: cover;" alt="@item.Title">
                        }
                        else
                        {
                            <div class="h-100 w-100 d-flex align-items-center justify-content-center text-muted">
                                <i class="bi bi-image fs-1 opacity-25"></i>
                            </div>
                        }

                        <span class="position-absolute top-0 end-0 m-3 badge bg-white text-dark shadow-sm fs-6 px-3 py-2 rounded-3">
                            @item.Price.ToString("C0")
                        </span>
                    </div>

                    <div class="card-body p-4">
                        <h6 class="card-title fw-bold text-truncate mb-1" style="font-family: 'Inter', sans-serif;">
                            <a asp-controller="Product" asp-action="Details" asp-route-id="@item.Id" class="text-decoration-none text-dark">
                                @item.Title
                            </a>
                        </h6>
                        <p class="text-muted small mb-3 text-truncate">@item.Description</p>

                        <div class="d-flex align-items-center justify-content-between">
                            <small class="text-muted"><i class="bi bi-geo-alt"></i> İstanbul</small>
                            <div class="d-flex gap-1 text-warning small">
                                <i class="bi bi-star-fill"></i>
                                <span class="text-dark fw-bold">4.8</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        }
    </div>
</div>

@section Scripts {
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        // Tüm grafikler için ortak minimalist konfigürasyon
        const chartConfig = {
            responsive: true,
            maintainAspectRatio: false,
            plugins: { legend: { display: false } },
            scales: {
                x: { display: false },
                y: { display: false, beginAtZero: false }
            },
            elements: {
                point: { radius: 0 },
                line: { borderWidth: 3, capStyle: 'round' }
            }
        };

        // 1. Orders Chart (Sipariş Adedi Grafiği - Statik)
        new Chart(document.getElementById('ordersChart'), {
            type: 'line',
            data: {
                labels: ['Pzt', 'Sal', 'Çar', 'Per', 'Cum', 'Cmt', 'Paz'],
                datasets: [{
                    data: [28, 35, 25, 45, 32, 50, 42], // Statik Örnek Veri
                    borderColor: '#DB4444',
                    tension: 0.4,
                    fill: true,
                    backgroundColor: 'rgba(219,68,68,0.1)'
                }]
            },
            options: chartConfig
        });

        // 2. Revenue Chart (Gelir Grafiği - Statik)
        new Chart(document.getElementById('revenueChart'), {
            type: 'line',
            data: {
                labels: ['Hafta 1', 'Hafta 2', 'Hafta 3', 'Hafta 4'],
                datasets: [{
                    data: [1200, 2100, 1800, 3500], // Statik Örnek Veri
                    borderColor: '#DB4444',
                    tension: 0.4,
                    fill: true,
                    backgroundColor: 'rgba(219,68,68,0.1)'
                }]
            },
            options: chartConfig
        });

        // 3. Users Chart (Aktif Kullanıcı Grafiği - Statik)
        new Chart(document.getElementById('usersChart'), {
            type: 'line',
            data: {
                labels: ['Oca', 'Şub', 'Mar', 'Nis', 'May', 'Haz'],
                datasets: [{
                    data: [150, 230, 190, 310, 280, 400], // Statik Örnek Veri
                    borderColor: '#DB4444',
                    tension: 0.4,
                    fill: true,
                    backgroundColor: 'rgba(219,68,68,0.1)'
                }]
            },
            options: chartConfig
        });
    </script>
}