@using BendenSana.Models
@model List<Order>

@{
    ViewData["Title"] = "Siparişlerim";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<style>
    /* Figma Uyumlu Stiller */
    .sidebar-title { font-family: 'Poppins', sans-serif; font-weight: 600; font-size: 16px; margin-bottom: 16px; color: #000; }
    .sidebar-link { display: block; color: rgba(0,0,0,0.5); text-decoration: none; margin-bottom: 8px; font-family: 'Poppins', sans-serif; font-size: 16px; margin-left: 35px; transition: all 0.3s; }
    .sidebar-link.active { color: #DB4444; opacity: 1; font-weight: 500; }
    .sidebar-link:hover { color: #DB4444; opacity: 1; }

    /* Sağ Taraf - Sipariş Kartı */
    .order-card {
        background: white;
        box-shadow: 0px 1px 13px rgba(0, 0, 0, 0.05);
        border-radius: 4px;
        padding: 24px;
        border: 1px solid #f0f0f0;
    }

    .table thead th {
        font-family: 'Poppins', sans-serif;
        font-weight: 500;
        font-size: 14px;
        border-bottom: 2px solid #eee;
        padding-bottom: 12px;
    }

    .table tbody td {
        font-family: 'Poppins', sans-serif;
        font-size: 14px;
        vertical-align: middle;
        padding: 16px 8px;
    }

    .status-badge {
        padding: 6px 12px;
        border-radius: 4px;
        font-size: 12px;
        font-weight: 500;
    }

    .btn-detail {
        color: #DB4444;
        font-weight: 500;
        text-decoration: none;
        transition: 0.2s;
    }
    .btn-detail:hover { text-decoration: underline; color: #c93e3e; }
</style>

<div class="container py-5">

    <div class="mb-5" style="opacity: 0.5; font-size: 14px; font-family: 'Poppins', sans-serif;">
        Home / <span style="font-weight: 500; opacity: 1;">My Account</span>
    </div>

    <div class="row">

        <div class="col-lg-3 mb-5 mb-lg-0">
            <div class="mb-4">
                <div class="sidebar-title">Manage My Account</div>
                <a href="@Url.Action("EditProfile", "Profile")" class="sidebar-link">My Profile</a>
                <a href="@Url.Action("Index", "Address")" class="sidebar-link">Address Book</a>
                <a href="@Url.Action("Index", "Payment")" class="sidebar-link">My Payment Options</a>
            </div>
            <div>
                <div class="sidebar-title">My Orders</div>
                <a href="@Url.Action("Index", "Order")" class="sidebar-link active">Siparişlerim</a> <a href="@Url.Action("MyProducts", "Product")" class="sidebar-link">Takas Ürünlerim</a>
                <a href="@Url.Action("Index", "Trade")" class="sidebar-link">Takas Tekliflerim</a>
            </div>
        </div>

        <div class="col-lg-9">

            @if (!Model.Any())
            {
                <div class="alert alert-light text-center py-5 border rounded">
                    <i class="bi bi-bag-x fs-1 text-muted mb-3 d-block"></i>
                    <p class="fs-5 mb-3">Henüz vermiş olduğunuz bir sipariş yok.</p>
                    <a asp-controller="Home" asp-action="Index" class="btn btn-dark px-4">Alışverişe Başla</a>
                </div>
            }
            else
            {
                <div class="order-card">
                    <div class="table-responsive">
                        <table class="table table-hover mb-0">
                            <thead>
                                <tr>
                                    <th>Sipariş Kodu</th>
                                    <th>Tarih</th>
                                    <th>Toplam Tutar</th>
                                    <th>Durum</th>
                                    <th>Ürün Sayısı</th>
                                    <th class="text-end">İşlemler</th>
                                </tr>
                            </thead>
                            <tbody>
                                @foreach (var order in Model)
                                {
                                    <tr>
                                        <td class="fw-bold">@order.OrderCode</td>
                                        <td>@order.CreatedAt.ToString("dd MMM yyyy HH:mm")</td>
                                        <td class="text-success fw-bold">@order.TotalPrice.ToString("C2")</td>
                                        <td>
                                            @{
                                                string badgeClass = "bg-secondary text-white";
                                                if (order.Status == OrderStatus.delivered) { badgeClass = "bg-success text-white"; }
                                                else if (order.Status == OrderStatus.shipped) { badgeClass = "bg-primary text-white"; }
                                                else if (order.Status == OrderStatus.cancelled) { badgeClass = "bg-danger text-white"; }
                                                else if (order.Status == OrderStatus.preparing) { badgeClass = "bg-warning text-dark"; }
                                            }
                                            <span class="status-badge @badgeClass">@order.Status</span>
                                        </td>
                                        <td>
                                            <span class="text-muted">
                                                <i class="bi bi-box-seam me-1"></i> @order.Items.Sum(i => i.Quantity) Adet
                                            </span>
                                        </td>
                                        <td class="text-end">
                                            <a asp-action="Details" asp-route-id="@order.Id" class="btn-detail">
                                                Detay Gör <i class="bi bi-arrow-right"></i>
                                            </a>
                                        </td>
                                    </tr>
                                }
                            </tbody>
                        </table>
                    </div>
                </div>
            }
        </div>

    </div>
</div>